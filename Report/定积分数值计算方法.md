## 定积分数值计算方法比较与实现

---

### 摘要

定积分计算在工程科学中具有重要应用，但实际问题常遇到原函数难以求出的情况，数值积分方法成为有效解决方案。基于《高等数学（2 - 1）》定积分概念，本文通过 Python 编程研究矩形法（左、中、右）与梯形法的数值实现与精度比较。以 \(\int_0^1 e^x \, dx\) 为测试案例，结果表明：在相同计算量下，梯形法精度最高，中矩形法次之。可视化分析清晰展示了各方法的收敛特性，为实际应用中的方法选择提供了参考依据。

**附：** 为便于查看代码实现细节，本文相关代码及可视化脚本可在 [GitHub](https://github.com/PaintHelloWorld/calculus-integration) 查看下载，包含完整实现与参数配置。

---

### 一、引言

定积分是高等数学的核心内容之一，广泛应用于物理、工程、经济学等领域，用于求解面积、体积、功、平均值等实际问题。尽管牛顿-莱布尼茨公式为定积分提供了理论解法，但在实际应用中往往面临困难：许多函数的原函数难以用初等函数表示；实际测量数据通常为离散点；部分函数表达式复杂，积分求解困难。

为此，数值积分方法应运而生，通过离散化近似计算积分值。其中，矩形法和梯形法作为最基础的数值积分方法，具有原理直观、易于实现的优点。矩形法直接源于黎曼和的定义，以矩形面积逼近曲边梯形；梯形法则采用线性插值，用梯形面积求和，通常能获得更好的精度。

本文旨在比较矩形法（左、中、右）与梯形法的数值积分性能。通过 Python 实现算法，选取典型函数进行测试，利用 matplotlib 进行结果可视化，分析各方法的误差收敛情况。研究不仅有助于深入理解数值积分原理，也为实际工程计算中的方法选择提供参考。

---

### 二、数值积分的基本原理

定积分的黎曼和定义提供了数值积分的思想基础：将积分区间分割为若干小区间，在每个小区间上取一点计算函数值，以矩形面积近似该区间的积分值，总和逼近整个积分。

![](D:\Hello Python\riemann_sum_convergence.png)

数值积分的核心在于用有限项求和代替无限求和过程，实现从连续到离散的转换。常见的数值积分方法包括矩形法和梯形法：矩形法采用水平线近似函数曲线，梯形法则用直线连接相邻函数点，形成梯形面积进行逼近。这些方法通过增加分割数提高精度，体现了“以直代曲”的数学思想。

![](D:\Hello Python\rect_vs_trap.png)

---

### 三、矩形法与梯形法原理

#### 3.1 矩形法

矩形法基于定积分的黎曼和定义，将区间 \([a, b]\) 等分为 \(n\) 个小区间，每个小区间宽度 \(\Delta x = \frac{b-a}{n}\)。根据取点的不同，分为三种形式：

- **左矩形法**：取每个小区间的左端点  
  \[
  \int_a^b f(x) \, dx \approx \sum_{i=0}^{n-1} f(x_i)\Delta x, \quad x_i = a + i\Delta x
  \]

- **右矩形法**：取每个小区间的右端点  
  \[
  \int_a^b f(x) \, dx \approx \sum_{i=1}^{n} f(x_i)\Delta x
  \]

- **中矩形法**：取每个小区间的中点  
  \[
  \int_a^b f(x) \, dx \approx \sum_{i=0}^{n-1} f\left(\frac{x_i+x_{i+1}}{2}\right)\Delta x
  \]

中矩形法通常精度更高，因为中点处的函数值更能代表该区间的平均高度。

#### 3.2 梯形法

梯形法采用线性插值思想，用连接相邻函数点的直线代替曲线。在区间 \([x_i, x_{i+1}]\) 上，用梯形面积 \(\frac{(f(x_i)+f(x_{i+1}))\Delta x}{2}\) 近似积分值，累加得到复合梯形公式：

\[
\int_a^b f(x) \, dx \approx \frac{\Delta x}{2}\left[f(x_0) + 2\sum_{i=1}^{n-1} f(x_i) + f(x_n)\right]
\]

梯形法的几何意义明确：将曲边梯形分解为若干小梯形之和。与矩形法相比，梯形法用斜线段近似曲线，通常能获得更高的精度，特别是当函数在该区间上近似线性变化时。

---

### 四、数值实验与结果分析

#### 4.1 实验设计

为验证矩形法与梯形法的数值积分性能，选取典型函数 \(f(x) = e^x\) 在区间 \([0, 1]\) 上的定积分作为测试案例。该积分的解析解为 \(\int_0^1 e^x \, dx = e - 1 \approx 1.718281828\)，便于误差计算与分析。

采用 Python 编程实现三种数值积分方法：
- **左矩形法**：取小区间左端点
- **中矩形法**：取小区间中点  
- **梯形法**：用梯形面积近似

设置分割数 \(n\) 为关键变量，分别测试 \(n = 4, 8, 16, 32, 64\) 等情况，比较不同分割数下的计算精度。

~~~python
#核心代码
import numpy as np

# 测试函数
def f(x):
    return np.exp(x)

# 积分区间
a, b = 0, 1
exact_value = np.exp(1) - 1  # 精确值

# 1. 左矩形法
def left_rectangle(f, a, b, n):
    dx = (b - a) / n
    total = sum(f(a + i * dx) for i in range(n))
    return total * dx

# 2. 中矩形法
def midpoint_rectangle(f, a, b, n):
    dx = (b - a) / n
    total = sum(f(a + (i + 0.5) * dx) for i in range(n))
    return total * dx

# 3. 梯形法
def trapezoidal(f, a, b, n):
    dx = (b - a) / n
    total = f(a) + f(b)
    for i in range(1, n):
        total += 2 * f(a + i * dx)
    return total * dx / 2
~~~



#### 4.2 计算结果

表1展示了不同分割数下三种方法的数值积分结果（程序运行结果）：

**表1：不同分割数下的积分结果比较**

| 分割数 \(n\) | 左矩形法 | 中矩形法 | 梯形法 | 精确值 |
| ------------ | -------- | -------- | ------ | ------ |
| 4            | 1.512    | 1.714    | 1.727  | 1.718  |
| 8            | 1.613    | 1.717    | 1.721  | 1.718  |
| 16           | 1.665    | 1.718    | 1.719  | 1.718  |
| 32           | 1.692    | 1.718    | 1.718  | 1.718  |
| 64           | 1.705    | 1.718    | 1.718  | 1.718  |

由表1可知：
1. **精度排序**：在相同分割数下，梯形法精度最高，中矩形法次之，左矩形法最低
2. **收敛速度**：当 \(n=32\) 时，梯形法与中矩形法的结果已与精确值高度吻合
3. **计算稳定性**：所有方法均随 \(n\) 增大而趋近精确值

#### 4.3 可视化分析

图3展示了 \(n=32\) 时三种方法的几何逼近效果：

![](D:\Hello Python\numerical_integration_results.png)

**图3：数值积分方法比较与误差收敛特性**

- **子图1**：左矩形法的矩形块高度取自区间左端点，整体低于真实曲线，导致系统性的低估
- **子图2**：中矩形法以区间中点高度构建矩形，更贴近曲线变化，精度显著提升
- **子图3**：梯形法通过连接相邻函数点形成梯形，实现了线性插值逼近
- **子图4**：误差收敛曲线显示，三种方法的误差均随 \(n\) 增大而减小，其中梯形法收敛最快

#### 4.4 误差收敛分析

图3的误差收敛曲线（对数坐标）揭示了重要规律：
1. **收敛速率**：
   - 左矩形法：误差近似以 \(O(1/n)\) 速率下降
   - 中矩形法：误差下降快于左矩形法
   - 梯形法：误差近似以 \(O(1/n^2)\) 速率下降，收敛最快

2. **计算效率**：
   当 \(n=16\) 时，梯形法已达到 \(10^{-5}\) 量级精度；而左矩形法需 \(n>100\) 才能达到相同精度。

3. **性价比分析**：
   从精度-计算量平衡角度，梯形法在 \(n=16 \sim 32\) 时即可获得满意精度，计算成本适中。

#### 4.5 方法对比总结

综合实验结果，三种数值积分方法的特点如下：

| 方法特性   | 左矩形法   | 中矩形法       | 梯形法       |
| ---------- | ---------- | -------------- | ------------ |
| 实现复杂度 | 简单       | 简单           | 中等         |
| 计算精度   | 低         | 中等           | 高           |
| 收敛速率   | \(O(1/n)\) | \(O(1/n^2)\)   | \(O(1/n^2)\) |
| 适用场景   | 快速估算   | 平衡精度与速度 | 高精度需求   |

对于 \(\int_0^1 e^x \, dx\) 这类光滑函数，梯形法在保证计算效率的同时提供了最优精度。

---

### 五、结论

本文通过理论分析与数值实验，系统比较了矩形法（左、中）与梯形法的数值积分性能。实验结果表明，在相同分割数下，梯形法精度最高，\(n=16\) 时误差已达 \(10^{-5}\) 量级，且收敛速率为 \(O(1/n^2)\)；中矩形法次之，在 \(n=32\) 时达到相似精度；左矩形法收敛最慢。对于光滑函数的积分计算，梯形法在实现复杂度与精度间取得了最佳平衡，推荐作为一般应用的首选。对于精度要求不高或计算资源受限的场景，中矩形法是良好替代。后续研究可拓展至辛普森法等更高阶方法，以进一步提升计算效率与适用范围。

---

### 参考文献

[1] 同济大学数学系. 高等数学（上册）[M]. 7版. 北京：高等教育出版社，2014.  

[2] 李庆扬，王能超，易大义. 数值分析[M]. 5版. 北京：清华大学出版社，2008.  

[3] Python Software Foundation. Python 3.12.3 documentation[EB/OL]. (2024). https://docs.python.org/3/  

[4] Matplotlib Development Team. Matplotlib documentation[EB/OL]. (2024). https://matplotlib.org/stable/contents.html  

[5] NumPy Community. NumPy documentation[EB/OL]. (2024). https://numpy.org/doc/stable/

